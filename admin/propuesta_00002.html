<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Propuesta de Ahorro | Ahorra Factura</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="../css/styles.css" rel="stylesheet">
    <!-- Añadir html2pdf -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body class="bg-gray-50">
    <header class="bg-white shadow-sm w-full py-4">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center">
                    <img src="/images/share/share-square.jpg" alt="Ahorra Factura" class="h-10 w-10 mr-3">
                    <div class="text-2xl font-bold text-blue-600">Ahorra Factura</div>
                </div>
                <div class="flex items-center gap-4">
                    <button onclick="imprimirPropuesta()" 
                        class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                        </svg>
                        Imprimir PDF
                    </button>
                    <div class="text-gray-600">Propuesta #00002</div>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        <!-- Información del Cliente -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h2 class="text-xl font-semibold mb-4">Cliente</h2>
                    <p class="text-gray-600">
                        Nombre: <span class="font-medium">FBS NUEVE S.L.</span><br>
                        Fecha: <span class="font-medium">4 de febrero de 2025</span><br>
                        Servicio: <span class="font-medium">Electricidad</span>
                    </p>
                </div>
                <div>
                    <h2 class="text-xl font-semibold mb-4">Situación Actual</h2>
                    <p class="text-gray-600">
                        Proveedor actual: <span class="font-medium">Iberdrola</span><br>
                        Tarifa actual: <span class="font-medium">Plan Comercio</span><br>
                        Gasto mensual: <span class="font-medium">414,67 €</span>
                    </p>
                </div>
            </div>
        </div>

        <!-- Comparativa -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-bold mb-6 text-center">Comparativa de Tarifas</h2>
            <div class="grid md:grid-cols-2 gap-8">
                <!-- Tarifa Actual -->
                <div class="border rounded-lg p-6 bg-gray-50">
                    <div class="text-xl font-semibold mb-4 text-gray-700">Tarifa Actual</div>
                    <ul class="space-y-3">
                        <li class="flex justify-between">
                            <span>Cuota mensual:</span>
                            <span class="font-medium">414,67 €</span>
                        </li>
                        <li class="flex justify-between border-t pt-2 mt-2">
                            <span>Total mensual:</span>
                            <span class="font-bold text-lg">414,67 €</span>
                        </li>
                    </ul>
                </div>

                <!-- Tarifa Propuesta -->
                <div class="border rounded-lg p-6 bg-blue-50 border-blue-200">
                    <div class="text-xl font-semibold mb-4 text-blue-700">Nuestra Propuesta</div>
                    <ul class="space-y-3">
                        <li class="flex justify-between">
                            <span>Cuota mensual:</span>
                            <span class="font-medium">164,88 €</span>
                        </li>
                        <li class="flex justify-between border-t pt-2 mt-2">
                            <span>Total mensual:</span>
                            <span class="font-bold text-lg text-blue-600">164,88 €</span>
                        </li>
                    </ul>
                </div>
            </div>
            <p class="text-sm text-gray-500 mt-4 text-center">* Esta estimación está basada en los consumos de sus últimas facturas</p>
        </div>

        <!-- Resumen de Ahorro -->
        <div class="bg-gradient-to-r from-blue-500 to-blue-700 rounded-lg shadow-md p-8 text-white">
            <div class="grid md:grid-cols-2 gap-8 text-center">
                <div>
                    <div class="text-3xl font-bold mb-2">2.997,48 €</div>
                    <div class="text-blue-100">Ahorro Anual</div>
                </div>
                <div>
                    <div class="text-3xl font-bold mb-2">299,75 €</div>
                    <div class="text-blue-100">Coste del Servicio</div>
                    <div class="text-sm mt-2">(10% del ahorro anual)</div>
                    <div class="text-sm mt-2 text-green-200">Descuento 50%: -149,88 €</div>
                    <div class="text-xl font-bold mt-2">Precio Final: 149,87 €</div>
                </div>
            </div>
        </div>

        <!-- Detalle del Servicio -->
        <div class="mt-8 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-bold mb-6">Detalle del Servicio</h2>
            
            <div class="space-y-6">
                <div>
                    <h3 class="font-bold mb-2">Descripción del servicio:</h3>
                    <p class="text-gray-600">
                        Análisis y optimización de facturas de suministros con el objetivo de identificar y aplicar medidas de ahorro para EL CLIENTE.
                    </p>
                </div>

                <div>
                    <h3 class="font-bold mb-2">Plazo de ejecución del servicio:</h3>
                    <p class="text-gray-600">
                        Una vez recibido el pago inicial (50% del importe total), LA EMPRESA realizará el servicio en un plazo máximo de una semana.
                    </p>
                </div>

                <div>
                    <h3 class="font-bold mb-4">Condiciones Económicas</h3>
                    <div class="bg-gray-50 p-4 rounded-lg space-y-2">
                        <p class="font-semibold">Coste total del servicio: <span class="text-blue-600">149,87 € (IVA incluido)</span></p>
                        <p>Pago inicial (50%): <span class="font-medium">74,94 €</span></p>
                        <p>Pago final (50%): <span class="font-medium">74,93 €</span></p>
                    </div>
                </div>

                <div>
                    <h3 class="font-bold mb-2">Forma de pago:</h3>
                    <ul class="list-disc pl-5 text-gray-600 space-y-1">
                        <li>Los pagos deberán realizarse mediante tarjeta bancaria a través del enlace que será proporcionado por LA EMPRESA.</li>
                        <li>El 50% inicial deberá abonarse antes de la finalización de la fecha de validez de este presupuesto.</li>
                        <li>El 50% restante deberá abonarse en un plazo máximo de tres (3) días naturales tras la finalización del servicio.</li>
                    </ul>
                </div>

                <div>
                    <h3 class="font-bold mb-2">Confidencialidad y Protección de Datos</h3>
                    <ul class="list-disc pl-5 text-gray-600 space-y-1">
                        <li>LA EMPRESA garantiza que toda la información proporcionada por EL CLIENTE será tratada de forma confidencial y utilizada únicamente para la prestación del servicio.</li>
                        <li>Los datos proporcionados se tratarán conforme a la normativa vigente en materia de protección de datos personales.</li>
                        <li>En ningún caso los datos del cliente serán cedidos, vendidos o utilizados para fines diferentes a los aquí especificados.</li>
                    </ul>
                </div>

                <div>
                    <h3 class="font-bold mb-2">Aceptación de la Propuesta</h3>
                    <p class="text-gray-600">
                        El cliente, mediante la firma de este documento o la respuesta escrita aceptando esta propuesta, manifiesta su conformidad con las condiciones del servicio y del presupuesto.
                    </p>
                </div>

                <div class="border-t pt-4">
                    <p class="text-gray-600">
                        Fecha de validez del presupuesto: <span class="font-medium">11 de febrero de 2025</span>
                    </p>
                </div>
            </div>
        </div>

        <!-- Pasos a Seguir -->
        <div class="mt-8 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-bold mb-6">Próximos Pasos</h2>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="text-center">
                    <div class="bg-blue-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-2xl font-bold text-blue-600">1</span>
                    </div>
                    <h3 class="font-bold mb-2">Aceptar Propuesta</h3>
                    <p class="text-gray-600">Confirma que quieres proceder con el cambio</p>
                </div>
                <div class="text-center">
                    <div class="bg-blue-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-2xl font-bold text-blue-600">2</span>
                    </div>
                    <h3 class="font-bold mb-2">Documentación</h3>
                    <p class="text-gray-600">Te ayudamos con todo el papeleo</p>
                </div>
                <div class="text-center">
                    <div class="bg-blue-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-2xl font-bold text-blue-600">3</span>
                    </div>
                    <h3 class="font-bold mb-2">¡Empieza a Ahorrar!</h3>
                    <p class="text-gray-600">Disfruta de tu nueva tarifa optimizada</p>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-gray-800 text-white py-8 mt-16">
        <div class="container mx-auto px-4 text-center">
            <p>© Ahorra Factura. Todos los derechos reservados.</p>
            <p class="text-gray-400 mt-2">Esta propuesta tiene una validez de una semana</p>
        </div>
    </footer>

    <style>
        @media print {
            button[onclick="imprimirPropuesta"] {
                display: none !important;
            }
        }
        /* Reducir tamaño de texto general */
        body {
            font-size: 0.8em;
        }
        /* Reducir tamaño de títulos */
        .text-2xl {
            font-size: 1.2rem !important;
            line-height: 1.6rem !important;
        }
        .text-xl {
            font-size: 1rem !important;
            line-height: 1.4rem !important;
        }
        .text-3xl {
            font-size: 1.5rem !important;
            line-height: 1.8rem !important;
        }
        /* Reducir espaciado entre secciones */
        .mb-8 {
            margin-bottom: 1rem !important;
        }
        .mt-8 {
            margin-top: 1rem !important;
        }
        .space-y-6 > * + * {
            margin-top: 0.75rem !important;
        }
        /* Reducir padding interno de los cuadros */
        .p-6 {
            padding: 0.75rem !important;
        }
        .p-8 {
            padding: 1rem !important;
        }
        .p-4 {
            padding: 0.5rem !important;
        }
        /* Ajustar gaps */
        .gap-8 {
            gap: 1rem !important;
        }
        .gap-6 {
            gap: 0.75rem !important;
        }
    </style>

    <script>
        // Verificar autenticación
        if (!sessionStorage.getItem('auth')) {
            window.location.href = 'login.html';
        }

        function imprimirPropuesta() {
            // Configuración del PDF
            const opt = {
                margin: 10,
                filename: `AhorraFactura-Propuesta-00002.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2,
                    useCORS: true,
                    letterRendering: true
                },
                jsPDF: { 
                    unit: 'mm', 
                    format: 'a4', 
                    orientation: 'portrait' 
                }
            };

            // Ocultar botón temporalmente
            const boton = document.querySelector('button');
            boton.style.display = 'none';

            // Generar PDF
            const element = document.body;
            html2pdf().set(opt).from(element).save().then(() => {
                // Restaurar botón
                boton.style.display = 'flex';
            });
        }
    </script>
</body>
</html> 